<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Financials - PTT ERP</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }
    body { display:flex; min-height:100vh; background:linear-gradient(135deg,#1e3c72,#2a5298); color:#fff; }

    /* Sidebar */
    .sidebar {
      width:240px; background: rgba(255,255,255,0.1); backdrop-filter: blur(12px);
      padding:20px; display:flex; flex-direction:column; gap:20px;
      box-shadow:2px 0 15px rgba(0,0,0,0.3); border-right:1px solid rgba(255,255,255,0.2);
    }
    .sidebar h2 { font-size:1.3rem; text-align:center; font-weight:600; }
    .sidebar nav { display:flex; flex-direction:column; gap:12px; }
    .sidebar nav a { text-decoration:none; padding:12px 15px; border-radius:12px; font-weight:500; color:#fff; transition:0.3s; display:flex; align-items:center; gap:10px; }
    .sidebar nav a:hover, .sidebar nav a.active { background: rgba(255,255,255,0.3); color:#000; font-weight:600; }

    /* Main */
    .main { flex:1; padding:30px; display:flex; flex-direction:column; gap:20px; }
    .header { display:flex; justify-content:space-between; align-items:center; }
    .header h1 { font-size:1.6rem; text-shadow:2px 2px 5px rgba(0,0,0,0.4); }

    .btn { background: #ffd369; color: #000; padding: 10px 18px; border-radius: 12px; font-weight: 600; text-decoration: none; transition: 0.3s; }
    .btn:hover { background: #ffb703; }

    /* Card */
    .card-container {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap:20px; margin-top:10px;
    }
    .card {
      background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius:20px; padding:20px;
      box-shadow:0 8px 20px rgba(0,0,0,0.3); transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.5); }
    .card h3 { font-size:1.1rem; margin-bottom:10px; }
    .card .value { font-size:1.4rem; font-weight:600; color:#ffd369; }

    /* Table */
    .table-section {
      margin-top: 20px; background: rgba(255,255,255,0.12); padding:20px; border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.3);
    }
    .table-section h2 { margin-bottom: 15px; }

    table { width:100%; border-collapse:collapse; border-radius:12px; overflow:hidden; }
    table thead { background: rgba(255,255,255,0.2); }
    table th, table td { padding:12px; text-align:center; border-bottom:1px solid rgba(255,255,255,0.2); }
    table tbody tr:hover { background: rgba(255,255,255,0.1); }

    .delete-btn { background:#ff4d4d; color:#fff; border:none; padding:6px 12px; border-radius:8px; cursor:pointer; transition:0.3s; }
    .delete-btn:hover { background:#e60000; }

    input, select { padding:6px 10px; border-radius:8px; border:none; outline:none; }
    input:focus, select:focus { box-shadow:0 0 8px rgba(255,211,105,0.8); }

    /* Filter */
    .filter-bar { margin-top:20px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .filter-bar label { font-weight:600; }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>PTT ERP</h2>
    <nav>
      <a href="index.html"><i class="fa-solid fa-house"></i> Home</a>
      <a href="financials.html" class="active"><i class="fa-solid fa-coins"></i> Financials</a>
      <a href="procurement.html"><i class="fa-solid fa-box"></i> Inventory</a>
      <a href="report.html"><i class="fa-solid fa-chart-line"></i> Report</a>
    </nav>
  </aside>

  <!-- Main content -->
  <div class="main">
    <div class="header">
      <h1>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financials)</h1>
      <button class="btn">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    </div>

    <!-- Summary -->
    <div class="card-container">
      <div class="card"><h3>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="value" id="incomeValue">‡∏ø1,200,000</div></div>
      <div class="card"><h3>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="value" id="expenseValue">‡∏ø950,000</div></div>
      <div class="card"><h3>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h3><div class="value" id="profitValue">‡∏ø250,000</div></div>
    </div>

    <!-- Filter -->
    <div class="filter-bar">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ:</label>
      <select id="yearFilter">
        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="2568">2568</option>
        <option value="2567">2567</option>
        <option value="2566">2566</option>
      </select>
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
      <select id="monthFilter">
        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="1">‡∏°.‡∏Ñ.</option>
        <option value="2">‡∏Å.‡∏û.</option>
        <option value="3">‡∏°‡∏µ.‡∏Ñ.</option>
        <option value="4">‡πÄ‡∏°.‡∏¢.</option>
        <option value="5">‡∏û.‡∏Ñ.</option>
        <option value="6">‡∏°‡∏¥.‡∏¢.</option>
        <option value="7">‡∏Å.‡∏Ñ.</option>
        <option value="8">‡∏™.‡∏Ñ.</option>
        <option value="9">‡∏Å.‡∏¢.</option>
        <option value="10">‡∏ï.‡∏Ñ.</option>
        <option value="11">‡∏û.‡∏¢.</option>
        <option value="12">‡∏ò.‡∏Ñ.</option>
      </select>
    </div>

    <!-- Table -->
    <div class="table-section">
      <h2>üìÑ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
      <table>
        <thead>
          <tr>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
          </tr>
        </thead>
        <tbody id="tbody">
          <tr>
            <td>28 ‡∏Å.‡∏Ñ. 2568</td>
            <td>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå</td>
            <td>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</td>
            <td>-‡∏ø35,000</td>
            <td><button class="delete-btn">‡∏•‡∏ö</button></td>
          </tr>
          <tr>
            <td>25 ‡∏Å.‡∏Ñ. 2568</td>
            <td>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ A</td>
            <td>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</td>
            <td>+‡∏ø150,000</td>
            <td><button class="delete-btn">‡∏•‡∏ö</button></td>
          </tr>
          <tr>
            <td>22 ‡∏Å.‡∏Ñ. 2568</td>
            <td>‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</td>
            <td>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</td>
            <td>-‡∏ø12,500</td>
            <td><button class="delete-btn">‡∏•‡∏ö</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

<script>
  const btnAdd = document.querySelector('.btn');
  const tbody = document.getElementById('tbody');
  const yearFilter = document.getElementById('yearFilter');
  const monthFilter = document.getElementById('monthFilter');

  function attachDeleteEvent(button) {
    button.addEventListener('click', function() {
      if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        button.closest('tr').remove();
        updateSummary();
      }
    });
  }

  document.querySelectorAll('.delete-btn').forEach(attachDeleteEvent);

  btnAdd.addEventListener('click', function(e){
    e.preventDefault();
    if(document.querySelector('#addForm')) return;

    const form = document.createElement('tr');
    form.id = 'addForm';
    form.innerHTML = `
      <td><input type="date" id="dateInput" required></td>
      <td><input type="text" id="descInput" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£" required></td>
      <td>
        <select id="typeInput" required>
          <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
          <option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
          <option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
        </select>
      </td>
      <td><input type="number" id="amountInput" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" required></td>
      <td>
        <button id="saveBtn" class="btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button id="cancelBtn" class="delete-btn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </td>
    `;
    tbody.prepend(form);

    document.getElementById('saveBtn').addEventListener('click', function(e){
      e.preventDefault();
      const date = document.getElementById('dateInput').value;
      const desc = document.getElementById('descInput').value.trim();
      const type = document.getElementById('typeInput').value;
      const amount = parseFloat(document.getElementById('amountInput').value);

      if(!date || !desc || !type || isNaN(amount)){
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      const monthMap = ['‡∏°.‡∏Ñ.','‡∏Å.‡∏û.','‡∏°‡∏µ.‡∏Ñ.','‡πÄ‡∏°.‡∏¢.','‡∏û.‡∏Ñ.','‡∏°‡∏¥.‡∏¢.','‡∏Å.‡∏Ñ.','‡∏™.‡∏Ñ.','‡∏Å.‡∏¢.','‡∏ï.‡∏Ñ.','‡∏û.‡∏¢.','‡∏ò.‡∏Ñ.'];
      const dt = new Date(date);
      const formattedDate = dt.getDate() + ' ' + monthMap[dt.getMonth()] + ' ' + (dt.getFullYear() + 543);

      const newRow = document.createElement('tr');
      newRow.innerHTML = `
        <td>${formattedDate}</td>
        <td>${desc}</td>
        <td>${type}</td>
        <td>${type==='‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö'?'+':'-'}‡∏ø${amount.toLocaleString()}</td>
        <td><button class="delete-btn">‡∏•‡∏ö</button></td>
      `;
      form.remove();
      tbody.prepend(newRow);
      attachDeleteEvent(newRow.querySelector('.delete-btn'));
      updateSummary();
      filterTable();
    });

    document.getElementById('cancelBtn').addEventListener('click', function(e){
      e.preventDefault();
      form.remove();
    });
  });

  function filterTable(){
    const yearVal = yearFilter.value;
    const monthVal = monthFilter.value;
    const monthMap = {'‡∏°.‡∏Ñ.':1,'‡∏Å.‡∏û.':2,'‡∏°‡∏µ.‡∏Ñ.':3,'‡πÄ‡∏°.‡∏¢.':4,'‡∏û.‡∏Ñ.':5,'‡∏°‡∏¥.‡∏¢.':6,'‡∏Å.‡∏Ñ.':7,'‡∏™.‡∏Ñ.':8,'‡∏Å.‡∏¢.':9,'‡∏ï.‡∏Ñ.':10,'‡∏û.‡∏¢.':11,'‡∏ò.‡∏Ñ.':12};

    tbody.querySelectorAll('tr').forEach(row=>{
      const dateText = row.cells[0].innerText; // "28 ‡∏Å.‡∏Ñ. 2568"
      const parts = dateText.split(' ');
      const day = parts[0], monthText = parts[1], year = parts[2];
      const month = monthMap[monthText];

      let show = true;
      if(yearVal!=='all' && year!==yearVal) show=false;
      if(monthVal!=='all' && month!==parseInt(monthVal)) show=false;
      row.style.display = show?'':'none';
    });
  }

  yearFilter.addEventListener('change', filterTable);
  monthFilter.addEventListener('change', filterTable);

  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Summary
  function updateSummary(){
    let income=0, expense=0;
    tbody.querySelectorAll('tr').forEach(row=>{
      if(row.style.display==='none') return;
      const type = row.cells[2].innerText;
      const value = parseFloat(row.cells[3].innerText.replace(/[‡∏ø,+-]/g,''));
      if(type==='‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö') income+=value;
      if(type==='‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢') expense+=value;
    });
    document.getElementById('incomeValue').innerText='‡∏ø'+income.toLocaleString();
    document.getElementById('expenseValue').innerText='‡∏ø'+expense.toLocaleString();
    document.getElementById('profitValue').innerText='‡∏ø'+(income-expense).toLocaleString();
  }

  updateSummary();
</script>

</body>
</html>
